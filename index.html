<!DOCTYPE html>
<html>

<style>

rect:hover {
  fill-opacity:0.5;
}
 
.axis {
	font-family: Georgia, "Times New Roman", Times, serif;
	font-size: 12px;
}

.axis path,
.axis line {
	  fill: none;
	  stroke: #000;
	  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

.toolTip {
  position: absolute;
  display: none;
  min-width: 80px;
  height: auto;
  background: none repeat scroll 0 0 #ffffff;
  border: 1px solid #000000;
  padding: 14px;
  text-align: center;
  border-radius:5px;
}
</style>
  
 <head>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<link rel="stylesheet" href="style.css">
 </head>
  
<body> 

<h1>2017 - H1B Application Analysis</h1>

<div class="areausage">

<div class="navigation">
<div class="pagination">
  
  <a class="active" href="#">Overview</a>
  <a href="top10.html">Top 10 Applicants</a>
  <a href="top10job.html">Top 10 JobType</a>
  <a href="ByState.html">H1B by State</a>
  <a href="about.html">About the Visualization</a>
  <a href="top10.html">&rang;</a>

</div>
</div>

<div class="text">

<p>
The H-1B is a visa in the United States under the Immigration and Nationality Act, section 101(a)(15)(H) which allows U.S. employers to employ foreign workers in specialty occupations.Every year, U.S. employers seeking highly skilled foreign professionals submit their petitions on the first business day in April for the pool of H-1B visa numbers for which U.S. Citizenship and Immigration Services (USCIS) controls the allocation. With a statutory limit of 65,000 visa numbers available for new hires and 20,000 additional visa numbers for foreign professionals who graduate with a master's degree or doctorate from a U.S. university,in recent years demand for H-1B visa numbers has outstripped the supply and the cap has been reached quickly, which you could see from the graph below. 
<br></br>
This visualization project provides an overview of how long it took to reach the cap limit of each year from 2006 - 2017, which U.S. employers submitted the most petition in 2017 , for which job roles most petitions are submitted, and highlights  which states these H-1B workers are employed.
<br></br>
From the chart below, we could see that in the years 2008-2009 and 2014-2017, the h1b cap limit for the year has reched in less than 5 days.
But in the years 2010 - 2013, it has taken more than 150 days to reah the cap limit, this may be mainly due to the global economic slow down after the recession in 2008 - 2009. 
</p>

</div>

<h4 align="center">No of days to reach H1B cap limit for the year</h4>
<div id="container" class="svg-container">
</div>

<script>

var svg = d3.select("div#container")
  .append("svg")
  .attr("preserveAspectRatio", "xMinYMin meet")
  .attr("viewBox", "0 0 960 410")
  .classed("svg-content", true);
 
var margin = {top: 45, right: 20, bottom: 20, left:70},
    width = 680,
    height = 280;
  
var tooltip = d3.select("body").append("div").attr("class", "toolTip");

var x = d3.scaleBand().rangeRound([0, width]).padding(0.2),
    y = d3.scaleLinear().rangeRound([height, 0]);
  
var g = svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.csv("cap.csv", function(error, data) {
      data.forEach(function(d) {
    d.days = +d.days;
	});
    x.domain(data.map(function(d) { return d.year; }));
    y.domain([0, d3.max(data, function(d) { return d.days; })]);

    g.append("g")
        .attr("class", "axis axis--x")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));
	
	g.append("text")             
      .attr("transform","translate(" + (width/2) + " ," +(height + margin.top + 20) + ")")
	  .attr("y", 0)
      .style("text-anchor", "middle")
	  .attr("font-family", "Georgia")
	  .attr("font-size", "12px")
	  .text("Year");

    g.append("g")
      	.attr("class", "axis axis--y")
      	.call(d3.axisLeft(y).ticks(5).tickFormat(function(d) { return d; }))
      .append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", -55)
		.attr("x",0 - (height / 4))
        .attr("dy", "0.71em")
        .attr("text-anchor", "center")
        .attr("fill", "black")
        .text("No of days to reach the cap");

        

    g.selectAll(".bar")
      	.data(data)
      .enter().append("rect")
        .attr("x", function(d) { return x(d.year); })
        .attr("y", function(d) { return y(d.days); })
        .attr("width", x.bandwidth())
        .attr("height", function(d) { return height - y(d.days); })
        .attr("fill","#377eb8" )
		.on("mousemove", function(d){
            tooltip
              .style("left", d3.event.pageX - 50 + "px")
              .style("top", d3.event.pageY - 70 + "px")
              .style("display", "inline-block")
              .html((d.year) + "<br>" + "No of days to reach the cap limit: " + (d.days));
        })
    		.on("mouseout", function(d){ tooltip.style("display", "none");});
			
	g.selectAll(".text")  		
	  .data(data)
	  .enter()
	  .append("text")
	  .attr("class","label")
	  .attr("x", (function(d) { return x(d.year); }  ))
	  .attr("y", function(d) { return y(d.days) - 40; })
	  .attr("dy", ".75em")
	  .attr("fill", "#E8336D")
	  .style("font-size", "12px")
	  .text(function(d) { return d.text; });
	  
		
    });



</script>

</div>

</body> 

</html>
